2025-01-20 16:47:03.3101-ERROR-Xim.AppApi.ActionFilters.ExceptionActionFilter-http://localhost/Users/52354861-1f89-43bf-b038-06926d9dcd1f-Delete:
The DELETE statement conflicted with the REFERENCE constraint "FK_user_role_users". The conflict occurred in database "db_cong", table "dbo.user_role", column 'user_id'.
The statement has been terminated.
System.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_user_role_users". The conflict occurred in database "db_cong", table "dbo.user_role", column 'user_id'.
The statement has been terminated.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader()
   at System.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at System.Data.SqlClient.SqlCommand.EndExecuteNonQuery(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.ExecuteImplAsync(IDbConnection cnn, CommandDefinition command, Object param) in /_/Dapper/SqlMapper.Async.cs:line 662
   at Xim.Domain.Mssql.Providers.MssqlProvider.ExecuteNonQueryTextAsync(IDbConnection cnn, String commandText, Dictionary`2 param, Nullable`1 timeout) in D:\Code\Cong TT\CodeBECong\Api\Xim.Domain.Mssql\Providers\MssqlProvider.cs:line 397
   at Xim.Domain.Mssql.Providers.MssqlProvider.ExecuteNonQueryTextAsync(String commandText, Dictionary`2 param, Nullable`1 timeout) in D:\Code\Cong TT\CodeBECong\Api\Xim.Domain.Mssql\Providers\MssqlProvider.cs:line 390
   at Xim.Domain.Mssql.Base.MssqlRepo`2.DeleteAsync[TData](Object id) in D:\Code\Cong TT\CodeBECong\Api\Xim.Domain.Mssql\Base\MssqlRepo.cs:line 89
   at Xim.Application.Services.UserService.DeleteAsync(Guid id) in D:\Code\Cong TT\CodeBECong\Api\Xim.Application\Services\UserService.cs:line 139
   at Xim.AppApi.Controllers.UserController.DeleteAsync(Guid id) in D:\Code\Cong TT\CodeBECong\Api\Xim.AppApi\Controllers\UserController.cs:line 82
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
ClientConnectionId:a39a32d4-ee90-459a-8c98-80ec99b5bafa
Error Number:547,State:0,Class:16

